# ๐ ูุธุงู ุฅุฏุงุฑุฉ ูุชูุงูู ูุฏุนู ุฃููุงุน ูุชุนุฏุฏุฉ ูู ุงููุชุงุฌุฑ ูุงูุตุงูุงุช

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุดุงูู ูุฏุนู ุฅุฏุงุฑุฉ ุนุฏุฉ ุฃููุงุน ูู ุงููุชุงุฌุฑ ูุงูุตุงูุงุช:
- โ ุตุงูุฉ ุฅูุชุฑูุช (Cyber Cafรฉ)
- โ ูุชุฌุฑ ุฅูุณุณูุงุฑุงุช ุฌูุงู ูุน ุฎุฏูุฉ ุงูุฅูุชุฑูุช
- โ ูุณุชูุฏุน ูุฑุชุจุท ุจุงููุชุฌุฑ
- โ ูุชุฌุฑ ูุญุฑููุงุช (ุจูุน/ุดุฑุงุก ูููุฏ)

---

## ๐ ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### 1. ุฅุฏุงุฑุฉ ุฃููุงุน ุงููุชุงุฌุฑ (Store Types)
- ุฅุถุงูุฉ/ุชุนุฏูู ุฃููุงุน ุงููุชุงุฌุฑ ูู ููุญุฉ ุงูุฃุฏูู
- ูู ููุน ูุชุฌุฑ ูู ููุฒุงุช ุฎุงุตุฉ (features JSONB)
- ุฏุนู ูุชุนุฏุฏ ุงููุบุงุช (ุนุฑุจูุ ุฅูุฌููุฒูุ ุชุฑูู)

### 2. ุฅุฏุงุฑุฉ ุงููุดุชุฑููู (Subscribers)
- ุชุณุฌูู ุจูุงูุงุช ุงููุดุชุฑููู ุงููุงููุฉ
- ุชุญุฏูุฏ ููุน ุงูุงุดุชุฑุงู (ููููุ ุฃุณุจูุนูุ ุดูุฑูุ ูุฎุตุต)
- ุชุญุฏูุฏ ุณุฑุนุฉ ุงูุฅูุชุฑูุช (Mbps/Kbps)
- ูุชุงุจุนุฉ ุงูุฑุตูุฏ ูุงููุฏููุนุงุช ูุงููุณุชุฎุฏูุงุช

### 3. ุฅุฏุงุฑุฉ ุงูุงุดุชุฑุงูุงุช (Subscriptions)
- ุฏุนู ุฃููุงุน ุงุดุชุฑุงูุงุช ูุชุนุฏุฏุฉ
- ูุชุงุจุนุฉ ุญุงูุฉ ุงูุฏูุน (pending, paid, partial, overdue)
- ุชุฌุฏูุฏ ุชููุงุฆู
- ุชุนููู/ุชูุนูู ุงูุงุดุชุฑุงู

### 4. ุงุณุชุฎุฏุงู ุงูุฅูุชุฑูุช (Internet Usage)
- ุชุณุฌูู ุฌูุณุงุช ุงูุงุณุชุฎุฏุงู
- ุชุชุจุน ูุฏุฉ ุงูุงุณุชุฎุฏุงู ูุงูุจูุงูุงุช ุงููุณุชุฎุฏูุฉ
- ุญุณุงุจ ุงูุชูููุฉ ุชููุงุฆูุงู
- ุฏุนู ุทุฑู ุฏูุน ูุชุนุฏุฏุฉ

### 5. ูุชุฌุฑ ุงููุญุฑููุงุช (Fuel Station)
- ุฅุฏุงุฑุฉ ุฃููุงุน ุงููุญุฑููุงุช
- ูุนุงููุงุช ุจูุน/ุดุฑุงุก
- ูุชุงุจุนุฉ ุงููุฎุฒูู ูุน ุชูุจููุงุช
- ุฅุฏุงุฑุฉ ุงูุฃุณุนุงุฑ ุงูุชุงุฑูุฎูุฉ
- ุชูุงุฑูุฑ ุงุณุชููุงู ููููุฉ

### 6. ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ
- ุชุฐููุฑ ุจุงูุชูุงุก ุงูุงุดุชุฑุงู (7 ุฃูุงู ูุจู)
- ุฅุดุนุงุฑุงุช ุงูุชูุช ุงูุงุดุชุฑุงู
- ุฅุดุนุงุฑุงุช ุงุณุชุญูุงู ุงูุฏูุน

---

## ๐๏ธ ูููู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ:

1. **store_types** - ุฃููุงุน ุงููุชุงุฌุฑ
2. **subscribers** - ุงููุดุชุฑููู
3. **subscriptions** - ุงูุงุดุชุฑุงูุงุช
4. **internet_usage** - ุงุณุชุฎุฏุงู ุงูุฅูุชุฑูุช
5. **subscriber_transactions** - ูุนุงููุงุช ุงููุดุชุฑููู
6. **fuel_types** - ุฃููุงุน ุงููุญุฑููุงุช
7. **fuel_transactions** - ูุนุงููุงุช ุงููุญุฑููุงุช
8. **fuel_inventory** - ูุฎุฒูู ุงููุญุฑููุงุช
9. **fuel_prices** - ุฃุณุนุงุฑ ุงููุญุฑููุงุช
10. **subscription_notifications** - ุฅุดุนุงุฑุงุช ุงูุงุดุชุฑุงูุงุช

---

## ๐ Views ููุชูุงุฑูุฑ

1. **expiring_subscriptions** - ุงููุดุชุฑููู ุนูู ูุดู ุงูุงูุชูุงุก
2. **daily_internet_usage_summary** - ููุฎุต ุงุณุชุฎุฏุงู ุงูุฅูุชุฑูุช ุงููููู
3. **daily_fuel_summary** - ููุฎุต ูุญุฑููุงุช ูููู
4. **current_fuel_inventory** - ูุฎุฒูู ุงููุญุฑููุงุช ุงูุญุงูู

---

## โ๏ธ Functions ู Triggers

### Functions:
- `update_subscriber_balance()` - ุชุญุฏูุซ ุฑุตูุฏ ุงููุดุชุฑู ุชููุงุฆูุงู
- `update_fuel_inventory()` - ุชุญุฏูุซ ูุฎุฒูู ุงููุญุฑููุงุช
- `create_expiry_notifications()` - ุฅูุดุงุก ุฅุดุนุงุฑุงุช ุงูุชูุงุก ุงูุงุดุชุฑุงู
- `update_updated_at_column()` - ุชุญุฏูุซ ุชุงุฑูุฎ ุงูุชุนุฏูู

### Triggers:
- ุชุญุฏูุซ ุฑุตูุฏ ุงููุดุชุฑู ุนูุฏ ุฅุถุงูุฉ ูุนุงููุฉ
- ุชุญุฏูุซ ูุฎุฒูู ุงููุญุฑููุงุช ุนูุฏ ุฅุถุงูุฉ ูุนุงููุฉ
- ุชุญุฏูุซ ุชุงุฑูุฎ ุงูุชุนุฏูู ุชููุงุฆูุงู

---

## ๐ ุฎุทูุงุช ุงูุชูููุฐ

### 1. ุชูููุฐ SQL Script

```sql
-- ูู ุจุชุดุบูู ููู update_database_multi_store_types.sql ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

### 2. ุฅุถุงูุฉ ุฃููุงุน ุงููุชุงุฌุฑ (ููุฌูุฏุฉ ุงูุชุฑุงุถูุงู)

ุงููุธุงู ูุญุชูู ุนูู 4 ุฃููุงุน ุงูุชุฑุงุถูุฉ:
- `cyber_cafe` - ุตุงูุฉ ุฅูุชุฑูุช
- `mobile_accessories` - ูุชุฌุฑ ุฅูุณุณูุงุฑุงุช ุฌูุงู
- `warehouse` - ูุณุชูุฏุน
- `fuel_station` - ูุชุฌุฑ ูุญุฑููุงุช

### 3. ุฅุถุงูุฉ ูุชุฌุฑ ุฌุฏูุฏ

```sql
-- ุฑุจุท ูุชุฌุฑ ุจููุน ูุนูู
UPDATE tenants 
SET store_type_id = (SELECT id FROM store_types WHERE code = 'cyber_cafe'),
    store_config = '{"hourly_rate": 5, "currency": "TRY"}'::jsonb
WHERE id = 'your-tenant-id';
```

### 4. ุฅุถุงูุฉ ูุดุชุฑู ุฌุฏูุฏ

```sql
INSERT INTO subscribers (
    tenant_id, name, phone, subscription_type, 
    internet_speed, start_date, end_date, created_by
) VALUES (
    'tenant-id', 'ุงุณู ุงููุดุชุฑู', '0123456789', 'monthly',
    '100Mbps', CURRENT_DATE, CURRENT_DATE + INTERVAL '1 month', 'user-id'
);
```

---

## ๐ ุฃูุซูุฉ ุงุณุชุฎุฏุงู

### ุฅุถุงูุฉ ุงุดุชุฑุงู ุฌุฏูุฏ:

```sql
INSERT INTO subscriptions (
    tenant_id, subscriber_id, subscription_type,
    start_date, end_date, price, currency, payment_method
) VALUES (
    'tenant-id', 'subscriber-id', 'monthly',
    '2024-01-01', '2024-02-01', 100, 'TRY', 'cash'
);
```

### ุชุณุฌูู ุงุณุชุฎุฏุงู ุฅูุชุฑูุช:

```sql
INSERT INTO internet_usage (
    tenant_id, subscriber_id, session_start, session_end,
    duration_minutes, internet_speed, data_used_mb, cost
) VALUES (
    'tenant-id', 'subscriber-id', 
    NOW(), NOW() + INTERVAL '2 hours',
    120, '100Mbps', 5000, 10
);
```

### ุฅุถุงูุฉ ูุญุฑููุงุช:

```sql
-- ุฅุถุงูุฉ ููุน ูุญุฑููุงุช
INSERT INTO fuel_types (tenant_id, code, name_ar, unit)
VALUES ('tenant-id', 'gasoline_95', 'ุจูุฒูู 95', 'liter');

-- ุฅุถุงูุฉ ูุนุงููุฉ ุดุฑุงุก
INSERT INTO fuel_transactions (
    tenant_id, fuel_type_id, transaction_type,
    quantity, unit_price, total_amount
) VALUES (
    'tenant-id', 'fuel-type-id', 'purchase',
    1000, 25.50, 25500
);
```

---

## ๐ ุฅุดุนุงุฑุงุช ุงูุชูุงุก ุงูุงุดุชุฑุงู

```sql
-- ุฅูุดุงุก ุฅุดุนุงุฑุงุช ุชููุงุฆูุงู (ูููู ุชุดุบูููุง ุนุจุฑ cron job)
SELECT create_expiry_notifications();
```

---

## ๐ ุงูุชูุงุฑูุฑ ุงููุชุงุญุฉ

### 1. ุงููุดุชุฑููู ุงูููุชููุฉ ุงุดุชุฑุงูุงุชูู:
```sql
SELECT * FROM expiring_subscriptions 
WHERE status = 'expiring_soon' OR status = 'expired';
```

### 2. ุงุณุชุฎุฏุงู ุงูุฅูุชุฑูุช ุงููููู:
```sql
SELECT * FROM daily_internet_usage_summary 
WHERE tenant_id = 'your-tenant-id' 
ORDER BY usage_date DESC;
```

### 3. ููุฎุต ุงููุญุฑููุงุช ุงููููู:
```sql
SELECT * FROM daily_fuel_summary 
WHERE tenant_id = 'your-tenant-id' 
AND transaction_date = CURRENT_DATE;
```

### 4. ูุฎุฒูู ุงููุญุฑููุงุช ููุฎูุถ:
```sql
SELECT * FROM current_fuel_inventory 
WHERE tenant_id = 'your-tenant-id' 
AND stock_status = 'low_stock';
```

---

## ๐๏ธ ุงูุชูุงูู ูุน ุงููุธุงู ุงูุญุงูู

ูุฐุง ุงููุธุงู ูุชูุงูู ุจุงููุงูู ูุน:
- โ ูุธุงู ุงูุตูุฏูู ุงููุงูู (cash_register)
- โ ูุธุงู ุงูููุงุชูุฑ (invoices_in, invoices_out)
- โ ูุธุงู ุงููุฎุฒูู (inventory_items)
- โ ูุธุงู ุงูููุธููู (employees, payroll)
- โ ูุธุงู ุงูุนููุงุก (partners, customer_transactions)

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูุฃูุงู**: ุชุฃูุฏ ูู ุชุทุจูู ุตูุงุญูุงุช ููุงุณุจุฉ ุนูู ุงูุฌุฏุงูู
2. **ุงูุฃุฏุงุก**: ุชู ุฅูุดุงุก indexes ูุชุญุณูู ุงูุฃุฏุงุก
3. **ุงููุณุฎ ุงูุงุญุชูุงุทู**: ูู ุจุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชูููุฐ
4. **ุงูุงุฎุชุจุงุฑ**: ุงุฎุชุจุฑ ูู ุจูุฆุฉ ุชุทููุฑ ุฃููุงู

---

## ๐ ุงููุชูุฌุฉ

ุจุนุฏ ุชูููุฐ ูุฐุง SQL scriptุ ุณุชุญุตู ุนูู:
- โ ูุธุงู ูุชูุงูู ูุฏุนู 4 ุฃููุงุน ูุชุงุฌุฑ
- โ ุฅุฏุงุฑุฉ ูุงููุฉ ูููุดุชุฑููู ูุงูุงุดุชุฑุงูุงุช
- โ ูุชุฌุฑ ูุญุฑููุงุช ูุงูู
- โ ุชูุงุฑูุฑ ูุฅุญุตุงุฆูุงุช ุดุงููุฉ
- โ ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ
- โ ูุงุจููุฉ ุงูุชูุณุน (ูููู ุฅุถุงูุฉ ุฃููุงุน ูุชุงุฌุฑ ุฌุฏูุฏุฉ)

---

**ุชู ุฅูุดุงุก ุงููุธุงู ุจูุฌุงุญ! ๐**

